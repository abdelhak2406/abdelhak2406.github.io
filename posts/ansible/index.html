<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><title>Ansible &#183; Abdelhak's website!</title>
<meta name=title content="Ansible &#183; Abdelhak's website!"><meta name=keywords content="linux,iac,automation,"><link rel=canonical href=https://abdelhak2406.github.io/posts/ansible/><link type=text/css rel=stylesheet href=/css/main.bundle.min.2b4bebea7a930667b464f1045e311cebccfa295fd43dfb249a31d7b86f035a86b7e383c54d28d95282e61e6d9f515b6e2fdf347153eda013eb3d715e31ff72c6.css integrity="sha512-K0vr6nqTBme0ZPEEXjEc68z6KV/UPfskmjHXuG8DWoa344PFTSjZUoLmHm2fUVtuL980cVPtoBPrPXFeMf9yxg=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.1271c22a557a15f10b5d38d2c87e49503604cfeffebadc1e7c267934e4b9f3ba1b74d81371219f9681dab2141482fc4ed2a8b462b179f0ef43a5f76d0575e85b.js integrity="sha512-EnHCKlV6FfELXTjSyH5JUDYEz+/+utwefCZ5NOS587obdNgTcSGfloHashQUgvxO0qi0YrF58O9DpfdtBXXoWw==" data-copy data-copied></script><script src=/js/zoom.min.js></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="Ansible"><meta property="og:description" content="It&rsquo;s all about Automation!"><meta property="og:type" content="article"><meta property="og:url" content="https://abdelhak2406.github.io/posts/ansible/"><meta property="og:image" content="https://abdelhak2406.github.io/posts/ansible/featured.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-01-07T00:00:00+00:00"><meta property="article:modified_time" content="2024-01-07T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://abdelhak2406.github.io/posts/ansible/featured.png"><meta name=twitter:title content="Ansible"><meta name=twitter:description content="It&rsquo;s all about Automation!"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Ansible","headline":"Ansible","abstract":"It\u0026rsquo;s all about Automation!","inLanguage":"en","url":"https:\/\/abdelhak2406.github.io\/posts\/ansible\/","author":{"@type":"Person","name":"Abdelhak Aissat"},"copyrightYear":"2024","dateCreated":"2024-01-07T00:00:00\u002b00:00","datePublished":"2024-01-07T00:00:00\u002b00:00","dateModified":"2024-01-07T00:00:00\u002b00:00","keywords":["linux","iac","automation"],"mainEntityOfPage":"true","wordCount":"1800"}]</script><meta name=author content="Abdelhak Aissat"><link href=mailto:abdelhak.aissat@protonmail.com rel=me><link href=https://gitlab.com/abdelhak2406 rel=me><link href=https://github.com/abdelhak2406 rel=me><link href=https://www.linkedin.com/in/abdelhak-aissat/ rel=me><script src=/lib/jquery/jquery.slim.min.js integrity></script><meta name=theme-color></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a></div><div style=padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">Abdelhak&rsquo;s website!</a></nav><nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12"><a href=/posts/ class="flex items-center"><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=Posts>Posts</p></a><a href=/awesome-websites/ class="flex items-center"><p class="text-base font-medium text-gray-500 hover:text-gray-900" title="Awesome Websites">Awesome Websites</p></a><a href=/about/ class="flex items-center"><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=About>About</p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400 h-12" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="ltr:mr-14 rtl:ml-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"><button id=appearance-switcher aria-label="Dark mode switcher" type=button><div class="flex items-center justify-center h-12 dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden h-12 dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center space-x-5 md:ml-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button style=margin-right:5px><div class="flex items-center justify-center h-12 dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden h-12 dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 -mr-2 md:hidden"><label id=menu-button for=menu-controller class=block><input type=checkbox id=menu-controller class=hidden><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper style=padding-top:5px class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/posts/ class="flex items-center"><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=Posts>Posts</p></a></li><li class=mt-1><a href=/awesome-websites/ class="flex items-center"><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title="Awesome Websites">Awesome Websites</p></a></li><li class=mt-1><a href=/about/ class="flex items-center"><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=About>About</p></a></li></ul></div></label></div></div><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Ansible</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div style=cursor:default class="flex flex-row flex-wrap items-center"><time datetime="2024-01-07 00:00:00 +0000 UTC">7 January 2024</time><span class="px-2 text-primary-500">&#183;</span><span>1800 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">9 mins</span></div><div style=cursor:pointer class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/linux/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">linux
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/iac/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">iac
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/automation/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">automation</span></span></span></div></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 alt="Abdelhak Aissat" src=/img/blowfish_logo_hu184ea2fa12490a2458ca388a16ab730e_227816_192x192_fill_box_center_3.png><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Abdelhak Aissat</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=mailto:abdelhak.aissat@protonmail.com target=_blank aria-label=Email rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://gitlab.com/abdelhak2406 target=_blank aria-label=Gitlab rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M510.486 284.482l-27.262-83.963c.012.038.016.077.028.115-.013-.044-.021-.088-.033-.132v-.01L429.1 33.871a21.328 21.328.0 00-20.445-14.6A21.038 21.038.0 00388.466 34L337.094 192.154H175L123.533 33.989A21.033 21.033.0 00103.35 19.274h-.113A21.467 21.467.0 0082.86 34L28.888 200.475l-.008.021v0c-.013.042-.019.084-.033.127.012-.038.017-.077.029-.115L1.514 284.482a30.6 30.6.0 0011.117 34.283L248.893 490.427c.035.026.074.041.109.067.1.072.2.146.3.214-.1-.065-.187-.136-.282-.2.015.012.033.02.05.031s.027.015.041.024h.006a11.992 11.992.0 001.137.7c.054.03.1.068.157.1.033.016.064.038.1.054s.053.02.077.032.038.015.056.023c.044.021.092.034.136.057.205.1.421.178.633.264.2.082.389.177.592.248l.025.011c.034.012.064.028.1.04s.083.032.125.046l.05.012c.053.016.11.024.163.039.019.006.042.009.063.015.284.086.579.148.872.213.115.026.225.062.341.083.017.0.032.009.05.012.038.008.073.021.112.027.062.011.122.031.186.04.049.007.1.0.151.012h.033a11.918 11.918.0 001.7.136h.019a11.971 11.971.0 001.7-.136h.033c.05-.008.1.0.153-.012s.124-.029.187-.04c.038-.006.073-.019.11-.027.017.0.032-.009.049-.012.118-.023.231-.059.349-.084.288-.064.578-.126.861-.21.019-.006.039-.008.059-.014.055-.017.113-.024.169-.041.016-.006.035-.007.051-.012.044-.013.086-.032.129-.047s.063-.028.1-.041l.026-.01c.214-.076.417-.175.627-.261s.394-.154.584-.245c.047-.023.1-.036.142-.059.018-.009.04-.015.058-.024s.053-.02.078-.033.068-.04.1-.056c.056-.028.106-.069.161-.1a12.341 12.341.0 001.132-.695c.029-.02.062-.035.092-.056.008-.006.017-.009.024-.015.035-.026.076-.043.11-.068l236.3-171.666A30.6 30.6.0 00510.486 284.482zM408.8 49.48l46.342 142.674H362.46zm-305.6.0 46.428 142.675H56.948zM26.817 299.251a6.526 6.526.0 01-2.361-7.308l20.34-62.42L193.835 420.6zm38.245-82.972h92.411L223.354 419.22zm183.416 273.83c-.047-.038-.092-.079-.138-.118-.009-.008-.018-.018-.028-.026-.091-.075-.18-.152-.268-.231-.172-.15-.341-.3-.5-.462.014.012.029.022.043.035l.055.046a12.191 12.191.0 001.091.929l.012.011c.018.013.033.03.051.045C248.689 490.263 248.58 490.19 248.478 490.109zm7.514-48.482L217.226 322.21 182.839 216.279H329.253zm7.935 48.107c-.091.079-.178.157-.27.233l-.032.028c-.047.038-.091.079-.136.117-.1.08-.209.152-.313.229.018-.013.033-.032.053-.044l.009-.009a11.69 11.69.0 001.086-.926c.014-.013.03-.024.044-.036s.038-.03.054-.047C264.262 489.435 264.1 489.586 263.927 489.734zm90.7-273.455h92.4l-18.91 24.23-139.468 178.7zm130.567 82.967L318.2 420.563 467.284 229.538l20.258 62.393A6.528 6.528.0 01485.189 299.246z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/abdelhak2406 target=_blank aria-label=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.linkedin.com/in/abdelhak-aissat/ target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10"><details open class="toc-right mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#its-all-about-automation>It&rsquo;s all about Automation!</a><ul><li><a href=#-automation-tools-are-here-for-that>==> Automation tools are here for that!!</a></li></ul></li><li><a href=#what-is-ansible>What is ansible?</a></li><li><a href=#getting-started>Getting started:</a><ul><li><a href=#ansible-architecture>Ansible architecture</a></li><li><a href=#installation>Installation</a></li><li><a href=#keywords>Keywords</a></li><li><a href=#basic-ssh>Basic SSH!</a></li></ul></li><li><a href=#running-ah-hoc-commands>Running Ah-Hoc Commands</a><ul><li><a href=#inventory>Inventory!</a></li><li><a href=#cfg-file>cfg file</a></li><li><a href=#modules>Modules</a><ul><li><a href=#arguments>Arguments</a></li></ul></li></ul></li><li><a href=#playbooks>Playbooks</a><ul><li><ul><li><a href=#when>&ldquo;when&rdquo;</a></li><li><a href=#tags>&ldquo;tags&rdquo;</a></li></ul></li></ul></li><li><a href=#roles>Roles</a></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#its-all-about-automation>It&rsquo;s all about Automation!</a><ul><li><a href=#-automation-tools-are-here-for-that>==> Automation tools are here for that!!</a></li></ul></li><li><a href=#what-is-ansible>What is ansible?</a></li><li><a href=#getting-started>Getting started:</a><ul><li><a href=#ansible-architecture>Ansible architecture</a></li><li><a href=#installation>Installation</a></li><li><a href=#keywords>Keywords</a></li><li><a href=#basic-ssh>Basic SSH!</a></li></ul></li><li><a href=#running-ah-hoc-commands>Running Ah-Hoc Commands</a><ul><li><a href=#inventory>Inventory!</a></li><li><a href=#cfg-file>cfg file</a></li><li><a href=#modules>Modules</a><ul><li><a href=#arguments>Arguments</a></li></ul></li></ul></li><li><a href=#playbooks>Playbooks</a><ul><li><ul><li><a href=#when>&ldquo;when&rdquo;</a></li><li><a href=#tags>&ldquo;tags&rdquo;</a></li></ul></li></ul></li><li><a href=#roles>Roles</a></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><h2 class="relative group">It&rsquo;s all about Automation!<div id=its-all-about-automation class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#its-all-about-automation aria-label=Anchor>#</a></span></h2><ul><li>Managing LARGE infrastructures is HARD!<ul><li><p>imagine having 100s of servers! that you need to configure!</p></li><li><p>imagine you DONT know what&rsquo;s inside evey server!</p></li><li><p>Hay it works here but not there BUT WHYY!!!!</p><ul><li>someone added this dark package in server number 32 and 80 but it isnt anywhere else!</li><li><strong>WHAT CAN WE DOOOO AAAAAAAAAAAAAAAAAAa!!</strong></li></ul></li><li><p>BASH SCRIPTS EVERYWHERE!</p><ul><li><strong>Idempotency</strong> : running the program multiple times and have it produice the same result<ul><li><a href=https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_intro.html#desired-state-and-idempotency target=_blank>https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_intro.html#desired-state-and-idempotency</a></li></ul></li><li>example <code>mkdir example</code><ul><li>if we want that command to be idempotent <code>mkdir -p example</code> which means if the example exist well nothing will be done!</li><li>With ansible, idempotency is backed in, sooooo no zillion if statment in your shell script and more easier readability and therefore maintainability!</li><li>Manual approaches to managing IT infrastructure, such as using scripts or SSH, can be time-consuming, error-prone, and difficult to scale. These methods also lack the ability to enforce standardized processes and configurations, making it challenging to maintain a consistent and secure environment.</li></ul></li></ul></li></ul></li></ul><h3 class="relative group">==> Automation tools are here for that!!<div id=-automation-tools-are-here-for-that class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#-automation-tools-are-here-for-that aria-label=Anchor>#</a></span></h3><ul><li>Automation tools provide a way to automate repetitive, time-consuming tasks such as<ul><li>server provisioning,</li><li>configuration management,</li><li>software deployments, and monitoring.</li><li>Automation tools can help ensure consistency and reliability in IT operations. By using automation to enforce standardized processes and configurations, IT teams can minimize errors and reduce the risk of downtime and security breaches.</li></ul></li></ul><h2 class="relative group">What is ansible?<div id=what-is-ansible class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#what-is-ansible aria-label=Anchor>#</a></span></h2><p>Ansible is an</p><ul><li>Open source, IT automation software application written in Python.</li><li>It can<ul><li>configure systems,</li><li>deploy software,</li><li>and orchestrate advanced workflows to support application deployment, system updates, and more.</li></ul></li></ul><p>Ansibleâ€™s main strengths are :</p><ul><li>simplicity and ease of use.</li><li>It also has a strong focus on security and reliability, featuring minimal moving parts. It uses OpenSSH for transport</li><li>Uses a human-readable language that is designed for getting started quickly without a lot of training.</li></ul><hr><h2 class="relative group">Getting started:<div id=getting-started class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#getting-started aria-label=Anchor>#</a></span></h2><h3 class="relative group">Ansible architecture<div id=ansible-architecture class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#ansible-architecture aria-label=Anchor>#</a></span></h3><ul><li>Where to install ansible? in the host? on the server machines?? WHERE??<ul><li>You only need it in the control host (or whatever it&rsquo;s called! (the workstation in the first image below))</li><li>It connects and does it&rsquo;s magic using ssh, it doesn&rsquo;t need anything else!</li></ul></li></ul><img class=thumbnailshadow src=img/workstation_server.png>
<img class=thumbnailshadow src=img/shema_2.png><hr><h3 class="relative group">Installation<div id=installation class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#installation aria-label=Anchor>#</a></span></h3><p>You only need to install it on the Management node machine!</p><ul><li>Using Python pip<ol><li><p>Using pip (check if pip is available)</p><ul><li>ensure pip is availible <a href=https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html#ensuring-pip-is-available target=_blank>https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html#ensuring-pip-is-available</a></li><li>then install: <code>python3 -m pip install --user ansible</code></li></ul></li><li><p>On <a href=https://docs.ansible.com/ansible/latest/installation_guide/installation_distros.html#installing-ansible-on-specific-operating-systems target=_blank>specific operationg System</a></p><ul><li>WinDows&mldr; CANNOT RUN only Manage Windows hosts! but you can use WSL <a href=https://docs.ansible.com/ansible/latest/os_guide/windows_faq.html#can-ansible-run-on-windows target=_blank>https://docs.ansible.com/ansible/latest/os_guide/windows_faq.html#can-ansible-run-on-windows</a></li><li>Fedora<ul><li><code>sudo dnf install ansible</code></li></ul></li><li>Ubuntu: (using Ppa)</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt update
</span></span><span class=line><span class=cl>sudo apt install software-properties-common
</span></span><span class=line><span class=cl>sudo add-apt-repository --yes --update ppa:ansible/ansible
</span></span><span class=line><span class=cl>sudo apt install ansible
</span></span></code></pre></div></li></ol></li></ul><h3 class="relative group">Keywords<div id=keywords class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#keywords aria-label=Anchor>#</a></span></h3><ul><li>Modules</li><li>roles</li><li>tags</li><li>Ansible playbooks</li><li>plays</li><li>tasks</li><li>hosts</li><li>inventory</li><li>Conditions</li><li>handlers</li></ul><h3 class="relative group">Basic SSH!<div id=basic-ssh class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#basic-ssh aria-label=Anchor>#</a></span></h3><p>Since Ansible uses ssh to connect into a remote server. We need to know a little bit about ssh so.</p><ol><li>Connect through ssh with terminal</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl> ssh user@ipaddress
</span></span><span class=line><span class=cl> ssh goku@192.168.122.165
</span></span><span class=line><span class=cl> ssh 192.168.122.165
</span></span></code></pre></div><ol start=2><li>check your <code>~/.ssh/known_hosts</code> file!</li><li>Create ansible specific key (apparently it&rsquo;s safer!)</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh-keygen -t ed25519 -C <span class=s2>&#34;write a comment here&#34;</span>
</span></span></code></pre></div><ul><li><code>-t</code>: specifying the key type</li><li><code>-C</code>: comment</li><li><code>-f</code>: if you want to specify the filepath(and name)</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh-keygen -t ed25519 -f  ~/.ssh/ansible2 -C <span class=s2>&#34;this is a comment&#34;</span>
</span></span></code></pre></div><ol start=4><li>add ssh key into a server!</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh-copy-id -i path/to/key.pub ipadress
</span></span><span class=line><span class=cl>ssh-copy-id -i ~/.ssh/ansible.pub 123.123.123.123
</span></span></code></pre></div><ol start=5><li>check <code>~/.ssh/autorized_keys</code></li></ol><ul><li><strong>Fedora Workstation</strong><ul><li><a href=https://www.linuxcapable.com/how-to-install-and-enable-ssh-on-fedora-linux/ target=_blank>https://www.linuxcapable.com/how-to-install-and-enable-ssh-on-fedora-linux/</a></li><li><a href=https://linuxconfig.org/how-to-install-start-and-connect-to-ssh-server-on-fedora-linux target=_blank>https://linuxconfig.org/how-to-install-start-and-connect-to-ssh-server-on-fedora-linux</a></li><li>you need to enable and start sshd</li><li><code>sudo ss -lt</code> : check open ports? i think</li></ul></li></ul><h2 class="relative group">Running Ah-Hoc Commands<div id=running-ah-hoc-commands class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#running-ah-hoc-commands aria-label=Anchor>#</a></span></h2><ul><li><a href=https://docs.ansible.com/ansible/latest/command_guide/cheatsheet.html#ansible-cli-cheatsheet target=_blank>https://docs.ansible.com/ansible/latest/command_guide/cheatsheet.html#ansible-cli-cheatsheet</a></li><li>Now that we connected throuh ssh and granted ourself the permissions to connect to the server let&rsquo;s run some basic commands:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ansible all --key-file ~/.ssh/ansible -i inventory -m ping
</span></span><span class=line><span class=cl>ansible rocky_servers --key-file -i inventory -m ping
</span></span></code></pre></div><h3 class="relative group">Inventory!<div id=inventory class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#inventory aria-label=Anchor>#</a></span></h3><p>The inventory is simply a file where we define all our servers and cloud instances that Ansible will manage</p><ul><li>How to create it ?<ul><li>We just create a file and put the IP adress for example :</li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>ubuntu_servers<span class=o>]</span>
</span></span><span class=line><span class=cl>192.168.122.165
</span></span><span class=line><span class=cl>192.168.122.116
</span></span><span class=line><span class=cl><span class=o>[</span>rocky_servers<span class=o>]</span>
</span></span><span class=line><span class=cl>192.168.122.153
</span></span></code></pre></div><p>or witout any specifications</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>192.168.122.165
</span></span><span class=line><span class=cl>192.168.122.116
</span></span><span class=line><span class=cl>192.168.122.153
</span></span></code></pre></div><ul><li>Ansible supports several ways to have inventories: <a href=https://docs.ansible.com/ansible/latest/inventory_guide/intro_inventory.html#how-to-build-your-inventory target=_blank>https://docs.ansible.com/ansible/latest/inventory_guide/intro_inventory.html#how-to-build-your-inventory</a></li></ul><h3 class="relative group">cfg file<div id=cfg-file class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#cfg-file aria-label=Anchor>#</a></span></h3><p>Is a file in which you can define some configuration such as the path to the ssh key, the <code>remote_username</code> that ansible will use to connect to the servers
the path to the inventory file, and many other things..</p><ul><li><p><a href=https://docs.ansible.com/ansible/latest/reference_appendices/config.html#ansible-configuration-settings target=_blank>https://docs.ansible.com/ansible/latest/reference_appendices/config.html#ansible-configuration-settings</a></p></li><li><p>NAME IT <code>ansible.cfg</code>: that&rsquo;s how ansible does it.</p></li><li><p>example of a config file</p></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=p>[</span><span class=n>defaults</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>inventory</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>inventory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>private_key_file</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>~/</span><span class=p>.</span><span class=n>ssh</span><span class=o>/</span><span class=n>ansible</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>remote_user</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>goku</span><span class=w>
</span></span></span></code></pre></div><ul><li><strong>Let&rsquo;s run our previous command now</strong></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ansible all --key-file ~/.ssh/ansible -i inventory -m ping
</span></span><span class=line><span class=cl>ansible all -m ping
</span></span></code></pre></div><ul><li>List all your adresses</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ansible all --list-hosts
</span></span><span class=line><span class=cl>ansible ubuntu_servers --list-all <span class=c1># specify category</span>
</span></span></code></pre></div><ul><li>Get a ton of informations about the servers!</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ansible all -m gather_facts
</span></span><span class=line><span class=cl>ansible all -m gather_facts --limit 192.168.122.153 
</span></span><span class=line><span class=cl>ansible localhost -m gather_facts <span class=c1># localhost facts!</span>
</span></span></code></pre></div><ul><li>Update servers</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ansible all -m apt -a <span class=nv>update_cache</span><span class=o>=</span><span class=nb>true</span> --become --ask-become-pass
</span></span></code></pre></div><p>this is the equivalent of doit <code>sudo apt update</code></p><ul><li><code>-m</code> apt : use the apt module (package manager)</li><li><code>-a</code> argument for the apt , which in this case means update the cache</li><li><code>--become</code> or <code>-b</code> : allow us to run it with root privileges (sudo)</li><li><code>--ask-become-pass</code> or <code>-K</code> allow us to prompt the request for the password</li></ul><h3 class="relative group">Modules<div id=modules class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#modules aria-label=Anchor>#</a></span></h3><ul><li><a href=https://docs.ansible.com/ansible/latest/plugins/module.html#modules target=_blank>https://docs.ansible.com/ansible/latest/plugins/module.html#modules</a></li></ul><p>In Ansible, Modules are small pieces of code that perform specific tasks on the managed servers. Modules can be used to perform a wide range of tasks, including file manipulation, package installation, service management, user management, and more.
For example the module <code>ping</code></p><ul><li><p>Ping yourself:</p><ul><li><code>ansible localhost -m ping</code></li></ul></li><li><p>the <strong>apt</strong> module is used for installing packages! or updating them for example</p></li><li><p>Ansible ships with A LOT of modules , but you can also create your own modules or use community built ones ( check ansible galaxy)</p></li></ul><h4 class="relative group">Arguments<div id=arguments class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#arguments aria-label=Anchor>#</a></span></h4><p>Modules take arguments for example :</p><ul><li><code>ansible all -m apt -a update_cache=true</code></li><li>udate_cache is an argument! which takes the value true</li></ul><h2 class="relative group">Playbooks<div id=playbooks class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#playbooks aria-label=Anchor>#</a></span></h2><ul><li><p>PLAYBOOK</p><ul><li>PLAY<ul><li>Tasks</li></ul></li></ul></li><li><p>In Ansible, playbooks are YAML files that define the tasks to be performed on the managed servers.</p></li><li><p>Playbooks provide a way to define the automation workflows that Ansible will execute, using a simple, human-readable syntax.</p></li><li><p>Each playbook consists of one or more <strong>plays</strong> which define a set of tasks to be performed on a specific set of servers. Each task in a play maps to an Ansible module, which performs a specific action on the managed servers.</p></li><li><p><strong>Plays</strong> provide a way to organize tasks and modules into logical groups, based on the servers or groups of servers they target.</p><ul><li>For example, a playbook might have a play that installs and configures web servers, and another play that sets up database servers.</li></ul></li></ul><p>A play consists of (generally!):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>(optional, but recommended)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hosts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tasks</span><span class=p>:</span><span class=w>
</span></span></span></code></pre></div><ul><li>update and upgrade (autoremove for removing unused packages)</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Update and upgrade packages on Debian/Ubuntu servers</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hosts</span><span class=p>:</span><span class=w> </span><span class=l>my_servers</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>become</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tasks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Update package cache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>apt</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>update_cache</span><span class=p>:</span><span class=w> </span><span class=kc>yes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Upgrade packages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>apt</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>upgrade</span><span class=p>:</span><span class=w> </span><span class=kc>yes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>autoremove</span><span class=p>:</span><span class=w> </span><span class=kc>yes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span></code></pre></div><ul><li>example of a playbook installing appache2 and update !</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl>- <span class=nt>hosts</span><span class=p>:</span><span class=w> </span><span class=l>all</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>become</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tasks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>update repository index</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>apt</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>update_cache</span><span class=p>:</span><span class=w> </span><span class=kc>yes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>install apache2 package</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>apt</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>apache2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>state</span><span class=p>:</span><span class=w> </span><span class=l>latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>add php support for apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>apt</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>libapache2-mod-php</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>state</span><span class=p>:</span><span class=w> </span><span class=l>latest</span><span class=w>
</span></span></span></code></pre></div><ul><li>uninstall appache</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl>- <span class=nt>hosts</span><span class=p>:</span><span class=w> </span><span class=l>all</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>become</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tasks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>install apache2 package</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>apt</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>apache2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>state</span><span class=p>:</span><span class=w> </span><span class=l>absent</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>add php support for apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>apt</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>libapache2-mod-php</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>state</span><span class=p>:</span><span class=w> </span><span class=l>latest</span><span class=w>
</span></span></span></code></pre></div><ul><li>Another example for fedora!</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w> </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>setup Fedora my own way! (this is a play!)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hosts</span><span class=p>:</span><span class=w> </span><span class=l>localhost</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>connection</span><span class=p>:</span><span class=w> </span><span class=l>local</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>become</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pre_tasks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Enable the RPM Fusion repository</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>dnf</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-{{ansible_distribution_major_version}}.noarch.rpm&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>state</span><span class=p>:</span><span class=w> </span><span class=l>present</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>when</span><span class=p>:</span><span class=w> </span><span class=l>ansible_distribution == &#39;Fedora&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name </span><span class=p>:</span><span class=w> </span><span class=l>update and upgrade packages!</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tasks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>install packages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>package</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>htop</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>tmux</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>vim</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>neovim</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>flatpak</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>setup Ubuntu (this is another play)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hosts</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu_servers</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>become</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tasks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>update repository index</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>apt</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>update_cache</span><span class=p>:</span><span class=w> </span><span class=kc>yes</span><span class=w>
</span></span></span></code></pre></div><ul><li>Running playbook<ul><li><code>ansible-playbook --ask-become-pass your_playbook.yml</code></li><li><code>ansible-playbook -K your_playbook.yml</code></li></ul></li></ul><h4 class="relative group">&ldquo;when&rdquo;<div id=when class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#when aria-label=Anchor>#</a></span></h4><p><a href=https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_conditionals.html#basic-conditionals-with-when target=_blank>https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_conditionals.html#basic-conditionals-with-when</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w> </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>setup Fedora my own way! (this is a play!)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hosts</span><span class=p>:</span><span class=w> </span><span class=l>localhost</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>connection</span><span class=p>:</span><span class=w> </span><span class=l>local</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>become</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tasks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Enable the RPM Fusion repository</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>dnf</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-{{ansible_distribution_major_version}}.noarch.rpm&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>state</span><span class=p>:</span><span class=w> </span><span class=l>present</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>when</span><span class=p>:</span><span class=w> </span><span class=l>ansible_distribution == &#39;Fedora&#39;</span><span class=w>
</span></span></span></code></pre></div><ul><li><code>when: ansible_facts['os_family'] == "Debian"</code></li></ul><p>we can get the ansible distribution with the <strong>gather facts!</strong> command</p><h4 class="relative group">&ldquo;tags&rdquo;<div id=tags class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#tags aria-label=Anchor>#</a></span></h4><ul><li><p>only run plays and tasks tagged with these values</p></li><li><p>you can have one or more tags</p></li><li><p>example of tags:</p></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w> </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>update rpm repo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hosts</span><span class=p>:</span><span class=w> </span><span class=l>localhost</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>connection</span><span class=p>:</span><span class=w> </span><span class=l>local</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>become</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tasks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Enable the RPM Fusion repository</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>tags </span><span class=p>:</span><span class=w> </span><span class=l>always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>dnf</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-{{ansible_distribution_major_version}}.noarch.rpm&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>state</span><span class=p>:</span><span class=w> </span><span class=l>present</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>when</span><span class=p>:</span><span class=w> </span><span class=l>ansible_distribution == &#39;Fedora&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span>- <span class=nt>name </span><span class=p>:</span><span class=w> </span><span class=l>update</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=nt>tags </span><span class=p>:</span><span class=w> </span><span class=l>always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=nt>dnf</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=nt>update_cache</span><span class=p>:</span><span class=w> </span><span class=kc>yes</span><span class=w>   
</span></span></span></code></pre></div><ul><li><p>to run tasks of specific tags</p><ul><li><code>ansible-playbook --ask-become-pass -t tagname your_playbook.yml</code></li></ul></li><li><p>Copy files :</p></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=o>-</span><span class=w> </span><span class=n>name</span><span class=w> </span>: <span class=nc>copy</span><span class=w> </span><span class=n>some</span><span class=w> </span><span class=n>file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>tags</span>: <span class=nc>html</span><span class=p>,</span><span class=w> </span><span class=n>soydev</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>copy</span>:
</span></span><span class=line><span class=cl>  <span class=nc>src</span>: <span class=nc>your</span><span class=o>/</span><span class=n>file</span><span class=o>/</span><span class=n>path</span><span class=o>/</span><span class=n>local</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>dest</span>: <span class=nc>where</span><span class=o>/</span><span class=n>to</span><span class=o>/</span><span class=n>put</span><span class=o>/</span><span class=n>it</span><span class=o>/</span><span class=k>in</span><span class=o>/</span><span class=n>server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>owner</span>: <span class=nc>goku</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>group</span>: <span class=nc>goku</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>mode</span><span class=w> </span>: <span class=mi>0664</span><span class=w>
</span></span></span></code></pre></div><ul><li>Unarchive (and download for DA internet!)</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=n>name</span><span class=w> </span>: <span class=nc>download</span><span class=w> </span><span class=n>uprchive</span><span class=w> </span><span class=n>and</span><span class=w> </span><span class=n>all</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>good</span><span class=w> </span><span class=n>things</span><span class=o>!</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>tags</span>: <span class=nc>html</span><span class=p>,</span><span class=w> </span><span class=n>soydev</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>unarchive</span>:
</span></span><span class=line><span class=cl>  <span class=nc>src</span>: <span class=nc>https</span>:<span class=c1>//releases.hashicorp.com/terraform/1.3.9/terraform_1.3.9_linux_amd64.zip
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>  </span><span class=n>dest</span>: <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>local</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>remote_src</span>: <span class=nc>yes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>mode</span><span class=w> </span>: <span class=mi>0755</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>owner</span>: <span class=nc>root</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>group</span>: <span class=nc>root</span><span class=w>
</span></span></span></code></pre></div><ul><li>Services :</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=o>-</span><span class=w> </span><span class=n>name</span>: <span class=nc>install</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>appache</span><span class=w> </span><span class=n>and</span><span class=w> </span><span class=n>php</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>hosts</span>: <span class=nc>rocky_servers</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=kr>become</span><span class=w> </span>: <span class=nc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>tasks</span>:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=w> </span><span class=n>name</span>: <span class=nc>install</span><span class=w> </span><span class=n>apache2</span><span class=w> </span><span class=n>package</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>dnf</span>:
</span></span><span class=line><span class=cl>      <span class=nc>name</span>: 
</span></span><span class=line><span class=cl>        <span class=o>-</span><span class=w> </span><span class=n>php</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>-</span><span class=w> </span><span class=n>httpd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>#<span class=w>    </span><span class=n>state</span>: <span class=nc>absent</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>-</span><span class=w> </span><span class=n>name</span>: <span class=nc>start</span><span class=w> </span><span class=n>httpd</span><span class=w> </span><span class=n>service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>service</span>:
</span></span><span class=line><span class=cl>      <span class=nc>name</span>: <span class=nc>httpd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>state</span>: <span class=nc>started</span><span class=w>
</span></span></span></code></pre></div><ul><li>Add users!<ul><li>check <code>/etc/passwd</code> before and after</li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=o>-</span><span class=w> </span><span class=n>name</span>: <span class=nc>add</span><span class=w> </span><span class=n>user</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>hosts</span>: <span class=nc>all</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=kr>become</span><span class=w> </span>: <span class=nc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>tasks</span>:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=w> </span><span class=n>name</span>: <span class=nc>create</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>new</span><span class=w> </span><span class=n>user</span><span class=w> </span><span class=p>(</span><span class=n>named</span><span class=w> </span><span class=n>klibsou</span><span class=w> </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>user</span>:
</span></span><span class=line><span class=cl>	  <span class=nc>name</span>: <span class=nc>klibsou</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span><span class=n>groups</span>: <span class=nc>root</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  
</span></span></span></code></pre></div><ul><li><a href=https://docs.ansible.com/ansible/latest/collections/ansible/builtin/user_module.html target=_blank>https://docs.ansible.com/ansible/latest/collections/ansible/builtin/user_module.html</a></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=o>-</span><span class=w> </span><span class=n>name</span>: <span class=nc>delete</span><span class=w> </span><span class=n>user</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>hosts</span>: <span class=nc>fedora_workstation</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=kr>become</span><span class=w> </span>: <span class=nc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>tasks</span>:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=w> </span><span class=n>name</span>: <span class=nc>delete</span><span class=w>  </span><span class=n>user</span><span class=w> </span><span class=p>(</span><span class=n>named</span><span class=w> </span><span class=n>klibsou</span><span class=w> </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>user</span>:
</span></span><span class=line><span class=cl>      <span class=nc>name</span>: <span class=nc>klibsou</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>groups</span>: <span class=nc>root</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>state</span>: <span class=nc>absent</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=n>remove</span>: <span class=nc>true</span><span class=w>
</span></span></span></code></pre></div><h2 class="relative group">Roles<div id=roles class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#roles aria-label=Anchor>#</a></span></h2><ul><li><a href=https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_reuse_roles.html#roles target=_blank>https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_reuse_roles.html#roles</a></li></ul><p>In Ansible, roles are a way to</p><ul><li><p>organize and reuse playbooks, by grouping related tasks, variables, and files into a self-contained unit.</p></li><li><p>A role is essentially a directory structure that contains all of the resources needed to perform a specific task or set of tasks.</p></li><li><p>Roles provide a way to break down complex playbooks into</p><ul><li>smaller</li><li>more manageable components
making it easier to share and reuse automation code across different projects and teams. They also promote modularity and maintainability, since each role can be developed and tested independently of the rest of the playbook.</li></ul></li></ul><p>So let&rsquo;s take do that!</p><ol><li>Create the directory name <code>roles</code></li><li>every sub directory is a role</li><li>inside a role directory you NEED to have one of these folders<ol><li>tasks</li><li>handlers</li><li>library</li><li>defaults</li><li>vars</li><li>files</li><li>templates</li><li>meta</li></ol><ul><li>Another way to say it<ul><li>&ldquo;An Ansible role has a defined directory structure with eight main standard directories. You must include at least one of these directories in each role. You can omit any directories the role does not use.&rdquo;</li></ul></li></ul></li></ol><ul><li>example!</li><li>IM lazy let&rsquo;s just use the example of this guy and one by chatGpt</li></ul><pre tabindex=0><code>myproject/
â”œâ”€â”€ playbook.yml
â””â”€â”€ roles
    â””â”€â”€ myrole
        â”œâ”€â”€ tasks
           â””â”€â”€ main.yml
</code></pre><ul><li><code>playbook.yml</code></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Configure myserver   </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hosts</span><span class=p>:</span><span class=w> </span><span class=l>myserver   </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>become</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>roles</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>myrole</span><span class=w>
</span></span></span></code></pre></div><hr><p>backround_image source : &ldquo;<a href=https://pantheon.tech/wp-content/uploads/2019/04/ansible.png%22 target=_blank>
https://pantheon.tech/wp-content/uploads/2019/04/ansible.png"</a></p></div></div><script>var oid="views_posts/ansible/index.md",oid_likes="likes_posts/ansible/index.md"</script><script type=text/javascript src=/js/page.min.5b1bad196a6075a1e11bae1dc95f24f67b610948a00525e347566c5a62338ea78f1c7224ab9a53873dcdb2a1a7d7d391b8a8ef45561297f68806c01315b0c4f6.js integrity="sha512-WxutGWpgdaHhG64dyV8k9nthCUigBSXjR1ZsWmIzjqePHHIkq5pThz3NsqGn19ORuKjvRVYSl/aIBsATFbDE9g=="></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/posts/manage-users-linux/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Mange users in linux</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2024-01-07 00:00:00 +0000 UTC">7 January 2024</time>
</span></span></a></span><span></span></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex flex-col list-none sm:flex-row"><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/tags/ title=Tags>Tags</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2024
Abdelhak Aissat</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.62060bb247f4de2b6dde45903668fefb68d792f365587605177b1227c0cf43588701edaca0cb40e2c8e2789bd5ce67c1d2a215b9fb258c3496a7cd25e7cb5fdf.js integrity="sha512-YgYLskf03itt3kWQNmj++2jXkvNlWHYFF3sSJ8DPQ1iHAe2soMtA4sjieJvVzmfB0qIVufsljDSWp80l58tf3w=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://abdelhak2406.github.io/ style=z-index:500><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>